<!-- @format -->

{% include 'base3.html' %}
{% load static %}

  <body>
   
    <main id="main" class="main">
      <div class="pagetitle">
      </div>
      <!-- End Page Title -->

      <section class="section dashboard">
          <!-- Left side columns -->
          <div class="col-lg-12">
            <div class="row">
               <!--Shops-->
              <div class="col-lg-3 col-md-12">
               <div class="card info-card customers-card">
               <a class="icon" href="{% url 'cattle_list' %}">
               <div class="card-body py-3 d-flex flex-row justify-content-between align-items-center text-center">
               <div class="card-icon rounded-circle d-flex align-items-center justify-content-center mb-2">
                 <img src="{% static '/images/cow.png' %}" width="50"/>
               </div>
               <h5 class="card-title mx-3 text-success">Cattle</h5>
               <h6 class="text-success">{{total_cattles}}</h6>
               </div>
              </a>
             </div>
            </div>
              <!-- Customer-->
              <div class="col-lg-3 col-md-12">
               <div class="card info-card customers-card">
               <a class="icon" href="{% url 'milking_list' %}">
               <div class="card-body py-3 d-flex flex-row justify-content-between align-items-center text-center">
               <div class="card-icon rounded-circle d-flex align-items-center justify-content-center mb-2">
                 <img src="{% static '/images/farmer.png' %}" width="50"/>
               </div>
               <h5 class="card-title mx-3 text-danger">Milk Production</h5>
               <h6 class="text-danger">{{ total_milk|floatformat:2 }}Ltr</h6>
               </div>
              </a>
             </div>
            </div>
              <!--End Card-->
                 <!-- Milk Order -->
              <div class="col-lg-3 col-md-12">
               <div class="card info-card customers-card">
               <a class="icon" href="{% url 'health_status_list' %}">
               <div class="card-body py-3 d-flex flex-row justify-content-between align-items-center text-center">
               <div class="card-icon rounded-circle d-flex align-items-center justify-content-center mb-2">
                 <img src="{% static '/images/healthcare.png' %}" width="50"/>
               </div>
               <h5 class="card-title mx-3 text-success">Health Status</h5>
              <h6 class="text-success">{{health}}</h6> 
               </div>
              </a>
             </div>
            </div>
              <!--End Card-->
               

             <!-- Stock -->
              <div class="col-lg-3 col-md-12">
               <div class="card info-card customers-card">
               <a class="icon" href="{% url 'feed_list' %}">
               <div class="card-body py-3 d-flex flex-row justify-content-between align-items-center text-center">
               <div class="card-icon rounded-circle d-flex align-items-center justify-content-center mb-2">
                 <img src="{% static '/images/feeding.png' %}" width="50"/>
               </div>
               <h5 class="card-title mb-1 text-warning">Feed & Stock</h5>
               <h6 class="text-warning">{{feed}}</h6>
               </div>
              </a>
             </div>
            </div>
             <!-- Billing Order -->
           <div class="col-lg-3 col-md-12">
               <div class="card info-card customers-card">
               <a class="icon" href="{% url 'breeding-list' %}">
               <div class="card-body py-3 d-flex flex-row justify-content-between align-items-center text-center">
               <div class="card-icon rounded-circle d-flex align-items-center justify-content-center mb-2">
                 <img src="{% static '/images/breeding.png' %}" width="50"/>
               </div>
               <h5 class="card-title mb-1 text-danger">Breeding</h5>
               <h6 class="text-danger">0</h6>
               </div>
              </a>
             </div>
            </div>
             <div class="col-lg-3 col-md-12">
               <div class="card info-card customers-card">
               <a class="icon" href="#">
               <div class="card-body py-3 d-flex flex-row justify-content-between align-items-center text-center">
               <div class="card-icon rounded-circle d-flex align-items-center justify-content-center mb-2">
                 <img src="{% static '/images/income.png' %}" width="50"/>
               </div>
               <h5 class="card-title mb-1 text-success">Income</h5>
               <h6 class="text-success">â‚¹{{income}}</h6>
               </div>
              </a>
             </div>
            </div>
            <div class="col-lg-3 col-md-12">
               <div class="card info-card customers-card">
               <a class="icon" href="#">
               <div class="card-body py-3 d-flex flex-row justify-content-between align-items-center text-center">
               <div class="card-icon rounded-circle d-flex align-items-center justify-content-center mb-2">
                 <img src="{% static '/images/business-report.png' %}" width="50"/>
               </div>
               <h5 class="card-title mb-1 text-warning">Reports</h5>
               <h6 class="text-warning">0</h6>
               </div>
              </a>
             </div>
            </div>
            <hr>
{% comment %} -------------Show Table Missed & Expired Conceiving Dates--------------------------  {% endcomment %}
  <div class="row">
    <!-- Chart Section -->
      <div class="col-md-4">
       <div class="card border-danger shadow-sm">
        <h5 class="bg-success text-white p-3">Breeding Status</h5>
       <canvas id="cattlePieChart" width="400" height="300"></canvas>
 
       </div>
     </div>

     <div class="col-md-4">
          <div class="card border-danger shadow-sm">
        
                <h5 class="bg-info text-white p-3">Milk Status</h5>
                <canvas id="monthlyMilkChart" width="400" height="300"></canvas>
            
          </div>
     </div>
    <!-- Missed & Expired Conceiving Dates -->
    <div class="col-md-4 mb-4">
        <div class="card border-danger shadow-sm">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">Missed & Expired Conceiving Dates After <strong class="text-warning">3 Days </strong></h5>
            </div>

            <div class="p-3">
                {% if missed_convincing %}
                    {% for record in missed_convincing %}
                        <div class="alert alert-danger">
                            <span class="mx-2">{{ record.batch }}</span><strong> {{ record.name }} </strong> 
                            <span class="mx-2">Conceiving Date: <strong>{{ record.convincing_date }}</strong></span>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-success">No missed Conceiving dates.</div>
                {% endif %}
            </div>
              <div class="p-3">
                {% if near_expiry_convincing %}
                    {% for record in near_expiry_convincing %}
                        <div class="alert alert-warning">
                        <span class="mx-2"> {{ record.batch }} </span> <strong>{{ record.name }} </strong>
                             <span class="mx-2">Conceiving Date: <strong>{{ record.convincing_date }}</strong></span>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-success">No Conceiving dates about to expire.</div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Near Expiry Conceiving Dates -->
    {% comment %} <div class="col-md-4 mb-4">
        <div class="card border-warning shadow-sm">
            <div class="card-header bg-warning text-white">
                <h5 class="mb-0">Conceiving Dates Expire in <strong class="text-danger">3 Days </strong></h5>
            </div>

        
        </div>
    </div> {% endcomment %}
  </div>     
  </div>
  </section>
  </main>
    <!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
      <div class="copyright">
        &copy; Copyright <strong>. All Rights Reserved</strong>
      </div>
      <div class="credits">
        Designed by <a href="#"><strong> JTECH VENTURES</strong
        ></a>
      </div>
    </footer>
    <!-- End Footer -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

<!-- Vendor JS Files -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<script>
 var ctx = document.getElementById('cattlePieChart').getContext('2d');
 var cattleChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ['Fresh', 'Inseminated', 'Pregnant', 'Dry'],
        datasets: [{
            data: [
                {{ data.fresh|default:0 }},
                {{ data.inseminated|default:0 }},
                {{ data.pregnant|default:0 }},
                {{ data.dry|default:0 }}
            ],
            backgroundColor: ['#4CAF50','#FFC107','#FF9800','#2196F3']
        }]
    },
    options: {
        responsive: false,
        plugins: {
            datalabels: {
                color: '#fff',
                formatter: (value) => value,
                font: {
                    weight: 'bold',
                    size: 16
                }
            }
        }
    },
    plugins: [ChartDataLabels]
});


// Monthly Milk Chart
  const ctxMilk = document.getElementById('monthlyMilkChart').getContext('2d');
  const monthlyMilkChart = new Chart(ctxMilk, {
    type: 'bar',
    data: {
      labels: [{% for month in months %}'{{ month }}'{% if not forloop.last %}, {% endif %}{% endfor %}],
      datasets: [{
        label: 'Total Milk (Liters)',
        data: [{% for total in monthly_totals %}{{ total }}{% if not forloop.last %}, {% endif %}{% endfor %}],
        backgroundColor: 'rgba(54, 162, 235, 0.6)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: true, position: 'top' },
        title: { display: true, text: 'Monthly Milk Production' }
      },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'Liters' } },
        x: { title: { display: true, text: 'Months' } }
      }
    }
  });
</script>


</body>







